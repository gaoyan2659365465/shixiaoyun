# 项目需求说明

## 一、项目概述
- 项目形式：微信小程序 + 后端服务 + 后台管理系统。
- 目标用户：新老客户（含通过 CRM 识别的老客户）。
- 核心功能：
  - 会员注册登录与账号管理。
  - 发现页社区交流与活动参与。
  - 积分获取（任务、签到）与积分消费（积分商城、大转盘抽奖等）。
  - 商城嵌入第三方站点 `mall.wisualarm.com`。
  - 与 CRM 及财务结算（微信提现、对公账户对账）打通。

## 二、技术栈与基础框架
- 小程序前端：
  - uni-app（HBuilder X），基于 Vue 3。
- 后端：
  - 语言：Java 8
  - 核心框架：Spring Boot 2.7.18
  - ORM：MyBatis-Plus
  - 数据库：MySQL 5.6
  - 构建工具：Maven
  - API 文档：Springdoc OpenAPI（基于 Swagger）
  - 分布式相关：Spring Cloud 2021.0.9
  - 中间件：RabbitMQ、Redis
- 安全要求：
  - 账号密码加密存储，密码需可逆，以便后续数据迁移。
  - 交付时需提供密码逆向方案与说明文档。

## 三、小程序端需求

### 1. 全局与基础导航
- 页面结构：底部 Tab 栏包含 3 个主页面：
  1. **我的**
  2. **发现**
  3. **商城**
- Tab 点击切换相应子页面。
- 支持游客模式浏览；参与具体活动或需要账号信息时引导至注册/登录页面。

### 2. 商城页（“商城” Tab）
- 功能：嵌入并对接站点 `mall.wisualarm.com`。
- 需求要点：
  - 小程序内 WebView 嵌入或其他方式实现无缝跳转/嵌入。
  - 与现有账号体系及积分/优惠券等数据的对接（根据后续接口设计）。

### 3. 我的页（“我的” Tab）
- **登录 / 注册功能**：
  - 手机号快捷登录。
  - 手机验证码登录。
  - 微信登录。
  - 勾选并展示：隐私协议、服务协议。
- **注册页面字段**：
  - 昵称
  - 邮箱
  - 手机号
  - 邮箱验证码
  - 密码
- **个人信息页**：
  - 展示与编辑：账号、电话等基础信息。
- **安全中心页**：
  - 修改密码功能。
- **CRM 绑定**：
  - 与 CRM 系统打通，用于识别历史老客户。
  - 老客户可被用于任务区分与专属任务派发。

### 4. 发现页（“发现” Tab）
- 顶部再分为两个子 Tab：
  1. 活动
  2. 社区

#### 4.1 社区页功能
- 模块分类（板块）：
  - 官方咨询
  - 产品建议
  - 新品测评
  - 好物分享
- 内容形式与支持：
  - 文本 + 图片（多图）+ 视频（短视频）。
  - 支持基础富文本（换行、表情等）即可，无需复杂排版。
- 浏览与筛选：
  - 按板块分类浏览帖子列表，支持按发布时间排序。
  - 列表项展示：标题/前几行内容、缩略图（如有）、作者昵称、发布时间、点赞数、评论数。
- 帖子详情：
  - 展示完整内容、图片/视频、评论列表。
  - 支持点赞/取消点赞、评论、分享。
- 发帖与评论：
  - 登录用户可发帖：选择板块、输入标题和内容，可上传图片/视频（限制数量与大小）。
  - 登录用户可对帖子进行评论（一期可仅支持一级评论）。
  - 用户可查看「我的帖子」「我的评论」列表。
- 分享能力：
  - 帖子/视频可分享到微信好友、微信群聊、朋友圈（使用微信小程序分享能力）。
- 内容审核与敏感词（基础版）：
  - 前台在用户提交时，对明显敏感词给出提示（前端 + 后端检查）。
  - 审核模式默认「先发后审」：发布后可在社区中展示，但后台可以随时删除/屏蔽。
  - 被屏蔽内容在前端展示为「内容已被管理员下架」等提示。

#### 4.2 活动页功能
- **任务推送**：
  - 支持通过外部链接点击直接唤起/跳转到小程序对应任务页面。
- **积分兑换功能**：
  - 积分商城。
  - 大转盘抽奖。
- **积分商城兑换内容类型**：
  - 卡券
  - 现金红包（提现到微信，对接对公支付账户，支持财务对账）
  - 优惠券
  - 增值服务
- **大转盘抽奖奖品类型**：
  - 积分（随机数额）
  - 优惠券
  - 红包

### 5. 积分体系相关功能

#### 5.1 我的积分
- 展示内容：
  - 当前积分数量。
  - 积分流水记录（获得/消耗明细）。
  - 积分兑换记录。

#### 5.2 赚积分
- 积分来源：
  - 任务积分。
  - 签到积分。
- 签到：
  - 提供签到控件，支持每日签到获取积分。

#### 5.3 任务积分
- 任务类型：
  - 限时任务积分。
  - 新手任务积分。
  - 专属客户任务积分（面向 CRM 中识别的老客户）。
- 任务入口形式：
  - 统一任务列表入口。
  - 推送广告位。
  - 消息滚动栏。
- 任务页面类型（示例）：
  - 问卷报名（海报说明 + 跳转问卷链接，提交后给积分）。
  - 投票。
  - 提交视频任务。
  - 提交截图任务（如朋友圈分享截图）。
- 积分发放逻辑：
  - 审核通过后积分到账。
  - 积分发放到个人账户。

## 四、后台管理系统需求（前端部分）

### 1. 积分商城管理
- 数据统计：
  - 参与任务账户数量统计。
  - 昨日、今日、近 7 日、近 30 日参与人数。
  - 任务参与人数排行。
- 积分兑换管理：
  - 微信提现记录（关联对公支付账户，支持财务对账）。
  - 兑换记录查询与导出（如有需要）。
- 兑换规则配置：
  - 兑换所需积分。
  - 每人限兑换次数。
  - 库存设置与维护。
  - 黑名单管理。
  - 指定客户可参与配置。
- 礼品/商品管理：
  - 礼品上架、下架。
  - 配置所需积分、库存数量、礼品图片。
  - 卡信息管理：卡号、卡密、兑换状态。
- 商品类型：
  - 虚拟卡券。
  - 现金红包。
  - 优惠券。
  - 增值服务。

### 2. 任务积分审核
- 自动审核：
  - 如签到积分等简单任务，自动审核并自动发放积分。
- 人工审核：
  - 列表展示任务记录。
  - 可查看任务提交内容（问卷结果、截图、视频等）。
  - 审核通过后执行积分到账操作。

### 3. 积分规则与任务模板配置
- 积分规则设置：
  - 支持按任务模板配置积分规则。
  - 支持空白新建任务并自定义规则。
- 任务模板库：
  - 类似“草料二维码”形式的模块化编辑。
  - 可编辑模块示例：培训、会议签到、安装设备积分、活动报名、材料收集、意见反馈、满意度调查、考试答题、投票、市场调研问卷、登记后领取资料等。
- 任务类型与行为示例：
  - 问卷报名：海报说明 + 跳转问卷按钮，提交后给积分。
  - 朋友圈分享任务（图片）。
  - 视频任务（上传或提交视频）。
- 任务条件配置：
  - 参加次数限制，避免重复刷积分。
  - 限定客户：
    - 新用户（如注册时长条件等）。
    - 指定客户群（如 CRM 分组）。
  - 任务时效（开始/结束时间）。
  - 任务审核方式（自动/人工）。

### 4. 社区内容管理
- 功能目标：
  - 为运营人员提供社区内容的审核、下架、置顶、屏蔽敏感内容等能力。
- 列表与筛选：
  - 按板块、发布时间、状态（待审核/已发布/已屏蔽）等筛选帖子。
  - 支持按用户、关键词模糊搜索。
- 审核与操作：
  - 查看帖子详细内容及相关评论。
  - 审核通过/驳回（可填写驳回原因）。
  - 对已发布内容执行删除、屏蔽、置顶、取消置顶等操作。
- 敏感词与举报（如一期内实现）：
  - 维护敏感词库：新增、删除、导入、导出。
  - 查看用户举报记录，对被举报内容进行快速定位与处理。
- 数据统计（可选）：
  - 简单统计帖子数量、评论数量、活跃用户数等指标，用于观察社区活跃度。

## 五、后端业务需求（初步）
- 后端具体业务细节根据实际业务规则进一步细化，包括但不限于：
  - 会员与账号体系设计（含与 CRM 的关联）。
  - 积分账户与流水模型设计。
  - 任务与模板配置、执行与审核流程。
  - 商城、卡券、红包、优惠券、增值服务等资源的统一建模。
  - 支付与提现对接微信及对公账户，提供对账支持。
  - 消息推送、任务提醒（可结合 RabbitMQ、Redis 等实现）。
- 以上内容需在详细设计阶段补充接口清单与数据结构设计。

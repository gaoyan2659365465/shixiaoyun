{"version":3,"file":"coupon.js","sources":["api/coupon.js"],"sourcesContent":["// api/coupon.js\r\n\r\nimport couponList from '@/data/coupon.js';\r\n\r\n/**获取卡券列表\r\n * @param {Object} params - 查询参数\r\n * @param {string} params.status - 卡券状态：unused(未使用)、used(已使用)、expired(已过期)、all(全部)\r\n * @param {number} params.page - 页码，从1开始\r\n * @param {number} params.pageSize - 每页数量\r\n * @returns {Promise<{code: number, data: {list: Array, total: number, hasMore: boolean}, message: string}>}\r\n */\r\nexport function getCouponList(params = {}) {\r\n  return new Promise((resolve) => {\r\n    setTimeout(() => {\r\n      const { status = 'all', page = 1, pageSize = 10 } = params;\r\n      \r\n      // 根据状态筛选\r\n      let filteredList = couponList;\r\n      if (status !== 'all') {\r\n        filteredList = couponList.filter(item => item.status === status);\r\n      }\r\n      \r\n      // 计算分页\r\n      const total = filteredList.length;\r\n      const start = (page - 1) * pageSize;\r\n      const end = start + pageSize;\r\n      const list = filteredList.slice(start, end);\r\n      const hasMore = end < total;\r\n      \r\n      resolve({\r\n        code: 200,\r\n        data: {\r\n          list,\r\n          total,\r\n          hasMore\r\n        },\r\n        message: '获取成功'\r\n      });\r\n    }, 300); // 模拟网络延迟\r\n  });\r\n}\r\n\r\n/**\r\n * 使用卡券\r\n * @param {string} couponId - 卡券ID\r\n * @returns {Promise<{code: number, data: null, message: string}>}\r\n */\r\nexport function useCoupon(couponId) {\r\n  return new Promise((resolve, reject) => {\r\n    setTimeout(() => {\r\n      const coupon = couponList.find(item => item.id === couponId);\r\n      \r\n      if (!coupon) {\r\n        reject({\r\n          code: 404,\r\n          data: null,\r\n          message: '卡券不存在'\r\n        });\r\n        return;\r\n      }\r\n      \r\n      if (coupon.status === 'used') {\r\n        reject({\r\n          code: 400,\r\n          data: null,\r\n          message: '卡券已使用'\r\n        });\r\n        return;\r\n      }\r\n      \r\n      if (coupon.status === 'expired') {\r\n        reject({\r\n          code: 400,\r\n          data: null,\r\n          message: '卡券已过期'\r\n        });\r\n        return;\r\n      }\r\n      \r\n      // 更新卡券状态为已使用\r\n      coupon.status = 'used';\r\n      \r\n      resolve({\r\n        code: 200,\r\n        data: null,\r\n        message: '使用成功'\r\n      });\r\n    }, 500); // 模拟网络延迟\r\n  });\r\n}\r\n\r\n/**\r\n * 获取卡券统计数据\r\n * @returns {Promise<{code: number, data: {unused: number, used: number, expired: number, total: number}, message: string}>}\r\n */\r\nexport function getCouponStats() {\r\n  return new Promise((resolve) => {\r\n    setTimeout(() => {\r\n      const unused = couponList.filter(item => item.status === 'unused').length;\r\n      const used = couponList.filter(item => item.status === 'used').length;\r\n      const expired = couponList.filter(item => item.status === 'expired').length;\r\n      const total = couponList.length;\r\n      \r\n      resolve({\r\n        code: 200,\r\n        data: {\r\n          unused,\r\n          used,\r\n          expired,\r\n          total\r\n        },\r\n        message: '获取成功'\r\n      });\r\n    }, 200);\r\n  });\r\n}"],"names":["couponList"],"mappings":";;AAWO,SAAS,cAAc,SAAS,IAAI;AACzC,SAAO,IAAI,QAAQ,CAAC,YAAY;AAC9B,eAAW,MAAM;AACf,YAAM,EAAE,SAAS,OAAO,OAAO,GAAG,WAAW,GAAI,IAAG;AAGpD,UAAI,eAAeA,YAAAA;AACnB,UAAI,WAAW,OAAO;AACpB,uBAAeA,YAAU,WAAC,OAAO,UAAQ,KAAK,WAAW,MAAM;AAAA,MAChE;AAGD,YAAM,QAAQ,aAAa;AAC3B,YAAM,SAAS,OAAO,KAAK;AAC3B,YAAM,MAAM,QAAQ;AACpB,YAAM,OAAO,aAAa,MAAM,OAAO,GAAG;AAC1C,YAAM,UAAU,MAAM;AAEtB,cAAQ;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,UACJ;AAAA,UACA;AAAA,UACA;AAAA,QACD;AAAA,QACD,SAAS;AAAA,MACjB,CAAO;AAAA,IACF,GAAE,GAAG;AAAA,EACV,CAAG;AACH;AAOO,SAAS,UAAU,UAAU;AAClC,SAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,eAAW,MAAM;AACf,YAAM,SAASA,YAAAA,WAAW,KAAK,UAAQ,KAAK,OAAO,QAAQ;AAE3D,UAAI,CAAC,QAAQ;AACX,eAAO;AAAA,UACL,MAAM;AAAA,UACN,MAAM;AAAA,UACN,SAAS;AAAA,QACnB,CAAS;AACD;AAAA,MACD;AAED,UAAI,OAAO,WAAW,QAAQ;AAC5B,eAAO;AAAA,UACL,MAAM;AAAA,UACN,MAAM;AAAA,UACN,SAAS;AAAA,QACnB,CAAS;AACD;AAAA,MACD;AAED,UAAI,OAAO,WAAW,WAAW;AAC/B,eAAO;AAAA,UACL,MAAM;AAAA,UACN,MAAM;AAAA,UACN,SAAS;AAAA,QACnB,CAAS;AACD;AAAA,MACD;AAGD,aAAO,SAAS;AAEhB,cAAQ;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,SAAS;AAAA,MACjB,CAAO;AAAA,IACF,GAAE,GAAG;AAAA,EACV,CAAG;AACH;AAMO,SAAS,iBAAiB;AAC/B,SAAO,IAAI,QAAQ,CAAC,YAAY;AAC9B,eAAW,MAAM;AACf,YAAM,SAASA,YAAU,WAAC,OAAO,UAAQ,KAAK,WAAW,QAAQ,EAAE;AACnE,YAAM,OAAOA,YAAU,WAAC,OAAO,UAAQ,KAAK,WAAW,MAAM,EAAE;AAC/D,YAAM,UAAUA,YAAU,WAAC,OAAO,UAAQ,KAAK,WAAW,SAAS,EAAE;AACrE,YAAM,QAAQA,YAAU,WAAC;AAEzB,cAAQ;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,UACJ;AAAA,UACA;AAAA,UACA;AAAA,UACA;AAAA,QACD;AAAA,QACD,SAAS;AAAA,MACjB,CAAO;AAAA,IACF,GAAE,GAAG;AAAA,EACV,CAAG;AACH;;;;"}